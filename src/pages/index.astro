---
import { contentfulClient } from "../lib/contentful";
import type { BlogPost } from "../lib/contentful";
import Layout from "../layouts/Layout.astro";

const entries = await contentfulClient.getEntries<BlogPost>({
  content_type: "blogPost",
});

const posts = entries.items.map((item) => {
  const { title, publishDate, slug } = item.fields;
  return {
    title,
    slug,
    date: new Date(publishDate).toLocaleDateString(),
  };
});
---

<Layout>
  <main>
    <div class="flex justify-center">
      <ul class="space-y-4 w-full max-w-2xl">
        {
          posts.map((post) => (
            <li class="p-4 rounded-lg bg-[var(--card-bg)] border border-[var(--border)]">
              <a
                href={`/posts/${post.slug}/`}
                class="flex items-center gap-4 hover:text-[var(--text-secondary)]"
              >
                <time class="text-sm text-[var(--text-secondary)] min-w-[100px] text-left">
                  {post.date}
                </time>
                <h2 class="text-xl font-semibold flex-1">{post.title}</h2>
              </a>
            </li>
          ))
        }
      </ul>
    </div>
  </main>
</Layout>
